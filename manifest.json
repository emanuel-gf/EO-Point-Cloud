{
    "name": "eo-point-cloud-generator",
    "description": "Generation of 3D Point Cloud from Earth Observation Data, including Elevation Models (DEM) and Sentinel-2 imagery. The model provides a seamlessly integration for downloading S2 and DEM data and returns a Point Cloud file (.ply) as well the mesh (.glb)",
    "license": {
        "name": "LGPLv3",
        "url": "https://www.gnu.org/licenses/gpl-3.0.txt",
        "description": "",
        "copyrights": [
            {"years": [2025],"company": "European Space Agency"}
        ]
    },
    "owner": "Emanuel.Goulart, Sebastien.Tetault",
    "inputs": {
        "cdse_key": {
            "type": "string",
            "description": "CDSE ACCESS_KEY_ID"
        },
        "cdse_secret": {
            "type": "string",
            "description": "CDSE SECRET ACCESS KEY"
        },
        "earth_data_hub_key":{
            "type": "string",
            "description": "API key from Earth Data Hub"
        },
        "bbox": {
            "type": "string",
            "description": "Comma-separated string of coordinates -> 'min_lon,min_lat,max_lon,max_lat'(left, bottom, right, top) (e.g:'3.2833,45.3833,11.2,50.1833') "
        },
        "sampled_fraction": {
            "type": "string",
            "description": "The fraction of the point cloud the be sampled in order to reduce computational resources. Default=0.2"
        }
    },
    "outputs": {
        "out": {
            "type": "Data",
            "description": "A point cloud file (.ply) ready to open it on OPEN3D."
        }
    },
    "models": {
        "point_cloud_generator": {
            "path": "models",
            "type": "python",
            "parameters": {
                "pythonVersion": "3.12.2",
                "baseImage": "python:3.12.2-slim-bookworm",
                "aptRequirements": [
                                {
                                "name": "gdal-bin",
                                "version": "3.6.2+dfsg-1+b2"
                                },
                                {
                                "name": "libgdal-dev",
                                "version": "3.6.2+dfsg-1+b2"
                                },
                                {
                                    "name": "libx11-6",
                                    "version": "2:1.8.12-1"
                                },
                                {
                                    "name": "libx11-dev",
                                    "version": "2:1.8.12-1"
                                },
                                {
                                    "name": "libx11-xcb1",
                                    "version": "2:1.8.12-1"
                                },
                                {
                                    "name": "libxcb1",
                                    "version": "1.17.0-2+b1"
                                },
                                {
                                    "name": "libxrandr2",
                                    "version": "2:1.5.4-1+b3"
                                },
                                {
                                    "name": "libxinerama1",
                                    "version": "2:1.1.4-3+b4"
                                },
                                {
                                    "name": "libxcursor1",
                                    "version": "1:1.2.3-1"
                                },
                                {
                                    "name": "libxi6",
                                    "version": "2:1.8.2-1"
                                },
                                {
                                    "name": "libgl1",
                                    "version": "1.7.0-1+b2"
                                },
                                {
                                    "name": "libglx-mesa0",
                                    "version": "25.0.7-2"
                                },
                                {
                                    "name": "libgl1-mesa-dri",
                                    "version": "25.0.7-2"
                                },
                                {
                                    "name": "libegl1",
                                    "version": "1.7.0-1+b2"
                                },
                                {
                                    "name": "libegl-mesa0",
                                    "version": "25.0.7-2"
                                },
                                {
                                    "name": "xvfb",
                                    "version": "2:21.1.16-1.3"
                                },
                                {
                                        "name": "libgomp1",
                                        "version":"15.2.0-1"
                                    },
                                    {
                                        "name": "python3-pip",
                                        "version": "25.1.1+dfsg-1"
                                    },
                                    {"name": "pkg-config",
                                    "version":""},
                                    {"name":"mesa-utils",
                                    "version":""}
                ],
                "pipRequirements": [
                            { "name": "aiohttp", "version": "3.9.5" },
                            {"name":"loguru","version":"0.7.3"},
                            { "name": "cartopy", "version": "0.24.1" },
                            { "name": "folium", "version": "0.19.5" },
                            { "name": "geopandas", "version": "1.0.1" },
                            { "name": "ipykernel", "version": "6.29.5" },
                            { "name": "matplotlib", "version": "3.10.1" },
                            { "name": "numpy", "version": "2.0" },
                            { "name": "opencv-python-headless", "version": "4.11.0.86" },
                            { "name": "pandas", "version": "2.2.3" },
                            { "name": "rasterio", "version": "1.4.3" },
                            { "name": "pystac-client", "version": "0.9.0" },
                            {"name": "packaging", "version":"24.1"},
                            {"name":"zarr", "version":"3.1.0"},
                            { "name": "xarray", "version": "2025.8.0"},
                            {"name": "open3d-cpu", "version":"0.19"},
                            {"name": "python-dotenv", "version":"1.1.0"},
                            {"name": "boto3","version": "1.34.20"},
                            {"name": "lxml",  "version": "5.3.1"},
                            {"name":"fsspec", "version": "2025.5.1"},
                            {"name":"dask", "version": "2025.5.1"}
                            ],
                "hardwareRequirements": {
                    "cpu": "4000m",
                    "ram": "7Gi"
                },
               "command": "main.py $(inputs.cdse_key) $(inputs.cdse_secret) $(inputs.earth_data_hub_key) $(inputs.bbox) $(inputs.sampled_fraction)"
             },
            "inputs": {
                "cdse_key":{
                    "type":"string"
                },
                "cdse_secret":{
                    "type": "string"
                },
                "earth_data_hub_key":{
                    "type": "string"
                },
                "bbox": {
                    "type": "string"
                },
                "sampled_fraction": {
                    "type": "string"
                }
            },
            "outputs": {
                "out_point_cloud": {
                    "type": "Data",
                    "glob": "point_cloud.ply"
                }
            }
        }
    }
}