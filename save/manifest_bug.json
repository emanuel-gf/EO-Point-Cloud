{
    "name": "eo-point-cloud-generator",
    "description": "Generation of 3D Point Cloud from Earth Observation Data, including Elevation Models (DEM) and Sentinel-2 imagery. The model provides a seamlessly integration for downloading S2 and DEM data and returns a Point Cloud file (.ply) as well the mesh (.glb)",
    "license": {
        "name": "LGPLv3",
        "url": "https://www.gnu.org/licenses/gpl-3.0.txt",
        "description": "",
        "copyrights": [
            {"years": [2025],"company": "European Space Agency"}
        ]
    },
    "owner": "Emanuel.Goulart, Sebastien.Tetault",
    "inputs": {
        "cdse_key": {
            "type": "string",
            "description": "CDSE ACCESS_KEY_ID"
        },
        "cdse_secret": {
            "type": "string",
            "description": "CDSE SECRET ACCESS KEY"
        },
        "earth_data_hub_key":{
            "type": "string",
            "description": "API key from Earth Data Hub"
        },
        "bbox": {
            "type": "string",
            "description": "Comma-separated string of coordinates -> 'min_lon,min_lat,max_lon,max_lat'(left, bottom, right, top) (e.g:'3.2833,45.3833,11.2,50.1833') "
        },
        "sampled_fraction": {
            "type": "number",
            "description": "The fraction of the point cloud the be sampled in order to reduce computational resources. Default=0.2"
        }
    },
    "outputs": {
        "point_cloud": {
            "type": "Data",
            "description": "A point cloud file (.ply) ready to open it on OPEN3D."
        }
    },
    "models": {
        "point_cloud_generator": {
            "path": "models",
            "type": "python",
            "parameters": {
                "pythonVersion": "3.12.2",
                "baseImage": "python:3.12.2-slim-bookworm",
                "aptRequirements": [{ "name": "gdal-bin", "version": "3.6.4+dfsg-1build4" },
                                    { "name": "libgdal-dev", "version": "3.6.4+dfsg-1build4" },
                                    { "name": "libx11-6", "version": "2:1.8.7-1build1" },
                                    { "name": "libx11-dev", "version": "2:1.8.7-1build1" },
                                    { "name": "libx11-xcb1", "version": "2:1.8.7-1build1" },
                                    { "name": "libxcb1", "version": "1.15-1ubuntu2" },
                                    { "name": "libxrandr2", "version": "2:1.5.4-1build1" },
                                    { "name": "libxinerama1", "version": "2:1.1.5-1build1" },
                                    { "name": "libxcursor1", "version": "1:1.2.2-1build1" },
                                    { "name": "libxi6", "version": "2:1.8.1-1build1" },
                                    { "name": "libgl1-mesa-glx", "version": "24.0.9-0ubuntu0.1" },
                                    { "name": "libegl1-mesa", "version": "24.0.9-0ubuntu0.1" }
                ],
                "pipRequirements": [
                            { "name": "aiohttp", "version": "3.9.5" },
                            {"name":"loguru","version":"0.7.3"},
                            { "name": "cartopy", "version": "0.24.1" },
                            { "name": "folium", "version": "0.19.5" },
                            { "name": "geopandas", "version": "1.0.1" },
                            { "name": "ipykernel", "version": "6.29.5" },
                            { "name": "matplotlib", "version": "3.10.1" },
                            { "name": "numpy", "version": "2.0" },
                            { "name": "opencv-python-headless", "version": "4.11.0.86" },
                            { "name": "pandas", "version": "2.2.3" },
                            { "name": "rasterio", "version": "1.4.3" },
                            { "name": "pystac-client", "version": "0.9.0" },
                            {"name": "packaging", "version":"24.1"},
                            { "name": "xarray", "version": "2025.8.0"},
                            {"name": "open3d", "version":"0.19"},
                            {"name": "python-dotenv", "version":"1.1.0"}
                            ],
                "hardwareRequirements": {
                    "cpu": "3000m",
                    "ram": "4Gi"
                },
                "command": "python main.py $(inputs.cdse_key) $(inputs.cdse_secret) $(inputs.earth_data_hub_key) $(inputs.bbox) $(inputs.sampled_fraction)"
            },
            "inputs": {
                "cdse_key":{
                    "type":"string"
                },
                "cdse_secret":{
                    "type": "string"
                },
                "earth_data_hub_key":{
                    "type": "string"
                },
                "bbox": {
                    "type": "string"
                },
                "sampled_fraction": {
                    "type": "numerical"
                }
            },
            "outputs": {
                "out_point_cloud": {
                    "type": "Data",
                    "glob": "point_cloud.ply"
                }
            }
        }
    }
}